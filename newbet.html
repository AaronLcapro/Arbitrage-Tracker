<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Arbitrage Tracker — New Bet</title>
  <base target="_top">
  <link rel="icon" type="image/jpeg" href="https://i.pinimg.com/736x/f2/f5/3a/f2f53ae6a0f77dde7f65eceaaa63c8a4.jpg">

  <style>
    :root{
      --bg:#0b0f17;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --stroke:rgba(255,255,255,.10);
      --radius:18px;
      --shadow:0 25px 80px rgba(0,0,0,.55);

      --bet1-accent: rgba(34,197,94,.22);
      --bet2-accent: rgba(148,163,184,.14);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:
        radial-gradient(900px 500px at 15% -10%, rgba(59,130,246,.18), transparent 60%),
        radial-gradient(700px 420px at 90% 0%, rgba(34,197,94,.16), transparent 55%),
        var(--bg);
      color:var(--text);
      min-height:100vh;
      padding:20px;
    }

    /* ===== TOP NAV ===== */
    .shell{ width:min(1200px, 100%); margin:0 auto; }
    .topnav{
      position:sticky;
      top:14px;
      z-index:200;
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:16px;
      border:1px solid var(--stroke);
      background: rgba(2,6,23,.55);
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      margin-bottom:16px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:1000;
      letter-spacing:.2px;
      margin-right:auto;
      white-space:nowrap;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background: linear-gradient(90deg, rgba(34,197,94,.95), rgba(59,130,246,.90));
      box-shadow: 0 0 20px rgba(59,130,246,.25);
    }
    .navlinks{ display:flex; gap:8px; flex-wrap:wrap; }
    .navbtn{
      text-decoration:none;
      padding:9px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      font-weight:900;
      font-size:13px;
      line-height:1;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .navbtn.active{
      background: linear-gradient(90deg, rgba(34,197,94,.35), rgba(59,130,246,.30));
      border-color: rgba(255,255,255,.18);
    }
    .navbtn:active{ transform: translateY(1px); }

    /* ===== MAIN LAYOUT ===== */
    .wrap{
      width:100%;
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap:16px;
      align-items:start;
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .header{
      padding:18px 18px 12px;
      border-bottom:1px solid var(--stroke);
      background: rgba(255,255,255,.03);
    }
    h1{ margin:0; font-size:18px; }
    .sub{ margin-top:6px; color:var(--muted); font-size:13px; }

    .content{ padding:16px 18px 18px; }
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin:0 0 6px;
    }
    input{
      width:100%;
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.55);
      color: var(--text);
      outline:none;
      transition:.15s ease;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.06);
    }
    input:focus{
      border-color: rgba(99,102,241,.55);
      box-shadow: 0 0 0 3px rgba(99,102,241,.18);
    }
    .full{ grid-column:1/-1; }
    .sectionTitle{
      grid-column:1/-1;
      margin-top:6px;
      color:#cbd5e1;
      font-size:12px;
      letter-spacing:.35px;
      text-transform:uppercase;
    }

    /* --- Bet box with NO background glow under dropdown --- */
    .betBox{
      grid-column:1/-1;
      border-radius:18px;
      padding:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(2,6,23,.35);
      position:relative;
    }
    .betBox::after{
      content:"";
      position:absolute;
      inset:-1px;
      border-radius:18px;
      pointer-events:none;
      box-shadow: 0 0 55px var(--bet-accent, rgba(99,102,241,.35));
      opacity:.9;
    }
    .bet1Glow::after{ --bet-accent: var(--bet1-accent); }
    .bet2Glow::after{ --bet-accent: var(--bet2-accent); }

    .betInner{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:8px;
      position:relative;
      z-index:1;
    }

    .btnRow{
      grid-column:1/-1;
      display:flex;
      gap:10px;
      margin-top:6px;
    }
    button{
      flex:1;
      padding:12px 14px;
      border:none;
      border-radius:14px;
      font-weight:900;
      cursor:pointer;
      color:#0b0f17;
      background: linear-gradient(90deg, rgba(34,197,94,.95), rgba(59,130,246,.90));
      /*box-shadow: 0 12px 30px rgba(59,130,246,.18); */
      transition:.15s ease;
    }
    button:hover{ transform: translateY(-1px); }
    button:active{ transform: translateY(0px); }
    .ghost{
      flex:.75;
      background: rgba(255,255,255,.06);
      color: var(--text);
      border:1px solid var(--stroke);
      box-shadow:none;
    }

    /* --- Right panel rows with reflection color --- */
    .side{ padding:16px 18px 18px; }
    .row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.04);
      margin-bottom:10px;
      font-size:13px;
      color:#cbd5e1;
      position:relative;
      overflow:hidden;
    }
    .row::before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(500px 140px at 18% 0%, var(--row-accent, rgba(99,102,241,.18)), transparent 60%);
      opacity:.80;
      pointer-events:none;
    }
    .row > *{ position:relative; }
    .val{ font-weight:1000; color:#e5e7eb; font-size:14px; white-space:nowrap; }
    .status{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(2,6,23,.55);
      color:#cbd5e1;
      font-size:12px;
      white-space:pre-wrap;
    }

    /* Custom select */
    .selectWrap{ position:relative; }
    .selectBtn{
      width:100%;
      display:flex;
      align-items:center;
      gap:10px;
      padding:11px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.55);
      color: var(--text);
      cursor:pointer;
      user-select:none;
    }
    /* remove blue underline/glow under dropdown */
    .selectBtn:focus, .selectBtn:focus-visible, .selectBtn:active{
      outline:none;
      box-shadow:none !important;
      border-color: rgba(255,255,255,.12);
    }

    .logo{
      width:22px;height:22px;border-radius:6px;
      object-fit:contain;
      background: rgba(255,255,255,.06);
      padding:2px;
    }
    .name{ font-weight:900; font-size:13px; }
    .caret{
      margin-left:auto;
      width:0;height:0;
      border-left:6px solid transparent;
      border-right:6px solid transparent;
      border-top:7px solid rgba(203,213,225,.85);
    }
    .menu{
      position:absolute; top:calc(100% + 8px); left:0; right:0;
      background: rgba(11,18,34,.98);
      border:1px solid rgba(255,255,255,.12);
      border-radius:16px;
      box-shadow: 0 25px 70px rgba(0,0,0,.6);
      overflow:hidden;
      z-index:50;
      display:none;
      max-height:280px;
      overflow:auto;
    }
    .menu.open{ display:block; }
    .item{
      display:flex; align-items:center; gap:10px;
      padding:11px 12px; cursor:pointer;
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .item:hover{ background: rgba(255,255,255,.06); }
    .chip{
      margin-left:auto;
      font-size:11px;
      font-weight:1000;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
    }

    /* colors */
    .c-stake{ background: rgba(37,99,235,.22); border-color: rgba(37,99,235,.45); }
    .c-ethan{ background: rgba(34,197,94,.14); border-color: rgba(34,197,94,.35); }
    .c-coolbet{ background: rgba(168,85,247,.18); border-color: rgba(168,85,247,.45); }
    .c-betsson{ background: rgba(249,115,22,.16); border-color: rgba(249,115,22,.16); }
    .c-leovegas{ background: rgba(249,115,22,.18); border-color: rgba(249,115,22,.45); }
    .c-pinnacle{ background: rgba(245,158,11,.14); border-color: rgba(245,158,11,.35); }
    .c-sport{ background: rgba(251,113,133,.18); border-color: rgba(251,113,133,.45); }
    .c-betway{ background: rgba(120,113,108,.18); border-color: rgba(120,113,108,.45); }
    .c-bet99{ background: rgba(21,128,61,.18); border-color: rgba(21,128,61,.45); }
    .c-na{ background: rgba(148,163,184,.12); border-color: rgba(148,163,184,.28); }
    .c-lost{ background: rgba(239,68,68,.16); border-color: rgba(239,68,68,.40); }

    .miniChip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      font-weight:1000;
      color:#e5e7eb;
      background: rgba(255,255,255,.06);
      max-width: 240px;
    }
    .miniChip .logo{ width:18px; height:18px; border-radius:5px; padding:2px; }
    .miniChip .txt{ overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

    @media (max-width: 980px){
      body{ padding:16px; }
      .topnav{ top:10px; }
      .wrap{ grid-template-columns:1fr; }
    }
  </style>
</head>

<body>
  <div class="shell">

    <!-- TOP MENU -->
   <div class="topnav">
  <div class="brand"><span class="dot"></span> Arbitrage Tracker</div>
  <div class="navlinks">
            <a class="navbtn" href="./index.html">Dashboard</a>
            <a class="navbtn" href="./newbet.html">New Bet</a>
            <a class="navbtn" href="./history.html">History</a>
            <a class="navbtn" href="./overview.html">Overview</a>
            <a class="navbtn" href="./calendar.html">Calendar</a>
  </div>
  <script>
  (function(){
    const current = "<?= page ?>"; // injecté par Apps Script
    document.querySelectorAll(".navbtn").forEach(a => a.classList.remove("active"));
    const map = {
      newbet: 'a[href*="page=newbet"]',
      history: 'a[href*="page=history"]',
      overview: 'a[href*="page=overview"]',
      calendar: 'a[href*="page=calendar"]'
    };
    const el = document.querySelector(map[current] || map.overview);
    if(el) el.classList.add("active");
  })();
</script>
</div>

    <div class="wrap">
      <div class="card">
        <div class="header">
          <h1>New Bet</h1>
          <div class="sub">Submit instant (pas de reset). Description → colonne B. Colonne G vide.</div>
        </div>

        <div class="content">
          <div class="grid">
            <div class="full">
              <label>Date</label>
              <input id="date" type="date" required />
            </div>

            <div class="full">
              <label>Description (col B)</label>
              <input id="desc" placeholder="ex: Joe Burrow Over/Under..." autocomplete="off" />
            </div>

            <div class="sectionTitle">Bet 1</div>
            <div id="bet1Box" class="betBox bet1Glow">
              <div class="betInner">
                <div>
                  <label>Bookmaker 1</label>
                  <div id="book1" class="selectWrap"></div>
                </div>
                <div>
                  <label>Bet Amount 1</label>
                  <input id="bet1" type="number" step="0.01" placeholder="ex: 250" />
                </div>
                <div>
                  <label>Odds 1</label>
                  <input id="odds1" type="number" step="0.0001" placeholder="ex: 1.95" />
                </div>
                <div></div>
              </div>
            </div>

            <div class="sectionTitle">Bet 2</div>
            <div id="bet2Box" class="betBox bet2Glow">
              <div class="betInner">
                <div>
                  <label>Bookmaker 2</label>
                  <div id="book2" class="selectWrap"></div>
                </div>
                <div>
                  <label>Bet Amount 2</label>
                  <input id="bet2" type="number" step="0.01" placeholder="ex: 205" />
                </div>
                <div>
                  <label>Odds 2</label>
                  <input id="odds2" type="number" step="0.0001" placeholder="ex: 2.41" />
                </div>
                <div></div>
              </div>
            </div>

            <div class="sectionTitle">Outcome</div>
            <div class="full">
              <label>Outcome (default: N/A)</label>
              <div id="outcome" class="selectWrap"></div>
            </div>

            <div class="btnRow">
              <button onclick="submitBet()">Submit</button>
              <button class="ghost" type="button" onclick="resetForm()">Reset</button>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="header">
          <h1>Arbitrage</h1>
          <div class="sub">Profit exact selon l’outcome + reflet couleur bookmaker</div>
        </div>
        <div class="side">
          <div id="row1" class="row">
            <div id="chip1"></div>
            <div class="val" id="p1">$0.00</div>
          </div>
          <div id="row2" class="row">
            <div id="chip2"></div>
            <div class="val" id="p2">$0.00</div>
          </div>
          <div class="row" style="--row-accent: rgba(148,163,184,.12);">
            <div>Risk total</div>
            <div class="val" id="riskEl">$0.00</div>
          </div>
          <div class="row" style="--row-accent: rgba(59,130,246,.16);">
            <div>Average ROI</div>
            <div class="val" id="roiAvg">0.00%</div>
          </div>
          <div class="status" id="status">Ready.</div>
        </div>
      </div>
    </div>
  </div>

<script>
  const URL = "https://script.google.com/macros/s/AKfycbz1_Bsd3SZO7JMaYs4bYlgrmYzD2DFH0LxWUe_dbnvUjmq3dxmCIjOFi4chYvTOGO28/exec";
  const $ = (id)=>document.getElementById(id);

  const ACCENTS = {
    "Stake": "rgba(37,99,235,.28)",
    "ETHAN-BET365": "rgba(34,197,94,.22)",
    "Coolbet": "rgba(168,85,247,.26)",
    "Betsson": "rgba(249,115,22,.16)",
    "LeoVegas": "rgba(249,115,22,.24)",
    "Pinnacle": "rgba(245,158,11,.22)",
    "SportInteraction": "rgba(251,113,133,.24)",
    "Betway": "rgba(120,113,108,.24)",
    "Bet99": "rgba(21,128,61,.24)",
    "N/A": "rgba(148,163,184,.14)",
    "Lost": "rgba(239,68,68,.18)"
  };

  const BOOKMAKERS = [
    { v:"Stake", cls:"c-stake", logo:"https://getesports.net/wp-content/uploads/sites/21169/2025/05/stake-logo.png" },
    { v:"ETHAN-BET365", cls:"c-ethan", logo:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/dc/Bet365_Logo.svg/2560px-Bet365_Logo.svg.png" },
    { v:"Coolbet", cls:"c-coolbet", logo:"https://images.squarespace-cdn.com/content/v1/52000104e4b08f2e358d94a9/1625452239841-S386IV6PRDBAF1A4J2OA/coolbet" },
    { v:"Betsson", cls:"c-betsson", logo:"https://play-lh.googleusercontent.com/8C8pB8E4jrYaQ4erIcquFLzGA7J98mvJxNVklC9B-BGN1zW_BVYWa9VdWzJqrtOaEkps" },
    { v:"LeoVegas", cls:"c-leovegas", logo:"https://s3-eu-west-1.amazonaws.com/tpd/logos/54c5ac3b0000ff00057cfb87/0x0.png" },
    { v:"Pinnacle", cls:"c-pinnacle", logo:"https://upload.wikimedia.org/wikipedia/en/7/72/Pinnacle_Logo.jpeg" },
    { v:"SportInteraction", cls:"c-sport", logo:"https://play-lh.googleusercontent.com/oiHxBwvYz38cyaW4hyDU61FhBUmUpnm6uHo-qtOAvBGCRtyqZr-3mZrbdLjfrlHe9Ms" },
    { v:"Betway", cls:"c-betway", logo:"https://upload.wikimedia.org/wikipedia/commons/9/95/Betway_logo.jpg" },
    { v:"Bet99", cls:"c-bet99", logo:"https://s3-eu-west-1.amazonaws.com/tpd/logos/616481a7f37ebd001dabc165/0x0.png" },
    { v:"N/A", cls:"c-na", logo:"" }
  ];
  const OUTCOMES = [...BOOKMAKERS, { v:"Lost", cls:"c-lost", logo:"" }];

  function fmtMoney(x){
    if (!isFinite(x)) return "$0.00";
    return (x < 0 ? "-" : "") + "$" + Math.abs(x).toFixed(2);
  }
  function fmtPct(x){
    if (!isFinite(x)) return "0.00%";
    return x.toFixed(2) + "%";
  }
  function setStatus(t){ $("status").textContent = t; }

  function makeMiniChip(opt){
    const wrap = document.createElement("div");
    wrap.className = `miniChip ${opt.cls || ""}`;
    if(opt.logo){
      const img = document.createElement("img");
      img.className = "logo";
      img.alt = "";
      img.referrerPolicy = "no-referrer";
      img.src = opt.logo;
      wrap.appendChild(img);
    }
    const txt = document.createElement("div");
    txt.className = "txt";
    txt.textContent = opt.v;
    wrap.appendChild(txt);
    return wrap;
  }

  /* Select with type-to-select (keyboard) */
  function createSelect(mountId, options, defaultValue){
    const mount = $(mountId);
    mount.innerHTML = "";

    const btn = document.createElement("button");
    btn.type = "button";
    btn.className = "selectBtn";
    btn.tabIndex = 0;

    const img = document.createElement("img");
    img.className = "logo";
    img.alt = "";
    img.referrerPolicy = "no-referrer";

    const name = document.createElement("div");
    name.className = "name";

    const caret = document.createElement("div");
    caret.className = "caret";

    btn.appendChild(img);
    btn.appendChild(name);
    btn.appendChild(caret);

    const menu = document.createElement("div");
    menu.className = "menu";

    let current = options.find(o => o.v === defaultValue) || options[0];
    let typed = "";
    let typeTimer = null;

    function apply(opt){
      current = opt;
      name.textContent = opt.v;
      if(opt.logo){
        img.style.display = "block";
        img.src = opt.logo;
      } else {
        img.style.display = "none";
        img.removeAttribute("src");
      }
    }
    function open(){ menu.classList.add("open"); }
    function close(){ menu.classList.remove("open"); }

    options.forEach(opt=>{
      const item = document.createElement("div");
      item.className = "item";

      const itImg = document.createElement("img");
      itImg.className = "logo";
      itImg.alt = "";
      itImg.referrerPolicy = "no-referrer";
      if(opt.logo){ itImg.src = opt.logo; } else { itImg.style.display = "none"; }

      const itName = document.createElement("div");
      itName.className = "name";
      itName.textContent = opt.v;

      const chip = document.createElement("div");
      chip.className = `chip ${opt.cls}`;
      chip.textContent = opt.v;

      item.append(itImg, itName, chip);

      item.addEventListener("click", ()=>{
        apply(opt);
        close();
        updateArb();
      });

      menu.appendChild(item);
    });

    btn.addEventListener("click", ()=>{
      menu.classList.toggle("open");
      typed = "";
    });

    btn.addEventListener("keydown", (e)=>{
      if(e.key.length === 1 && /[a-z0-9]/i.test(e.key)){
        typed += e.key.toLowerCase();
        clearTimeout(typeTimer);
        typeTimer = setTimeout(()=> typed = "", 600);

        const found = options.find(o => o.v.toLowerCase().startsWith(typed));
        if(found){
          apply(found);
          open();
          updateArb();
        }
      }
      if(e.key === "Enter"){
        menu.classList.toggle("open");
        e.preventDefault();
      }
      if(e.key === "Escape"){
        close();
      }
    });

    document.addEventListener("click", (ev)=>{
      if(!mount.contains(ev.target)) close();
    });

    apply(current);
    mount.append(btn, menu);

    return {
      getValue:()=>current.v,
      getObj:()=>current,
      setValue:(v)=>{ const o=options.find(x=>x.v===v); if(o) apply(o); }
    };
  }

  const selBook1 = createSelect("book1", BOOKMAKERS, "ETHAN-BET365");
  const selBook2 = createSelect("book2", BOOKMAKERS, "N/A");
  const selOutcome = createSelect("outcome", OUTCOMES, "N/A");

  // date default today
  const t = new Date();
  $("date").value = `${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;

  function setGlowVars(){
    const b1 = selBook1.getValue();
    const b2 = selBook2.getValue();
    document.documentElement.style.setProperty("--bet1-accent", ACCENTS[b1] || "rgba(99,102,241,.35)");
    document.documentElement.style.setProperty("--bet2-accent", ACCENTS[b2] || "rgba(99,102,241,.35)");
  }

  function resetForm(){
    $("desc").value = "";
    $("bet1").value = ""; $("odds1").value = "";
    $("bet2").value = ""; $("odds2").value = "";
    selBook1.setValue("ETHAN-BET365");
    selBook2.setValue("N/A");
    selOutcome.setValue("N/A");
    updateArb();
    $("desc").focus();
    setStatus("Reset.");
  }

  function updateArb(){
    const b1 = Number($("bet1").value || 0);
    const o1 = Number($("odds1").value || 0);
    const b2 = Number($("bet2").value || 0);
    const o2 = Number($("odds2").value || 0);

    const profitIf1 = (b1 * (o1 - 1)) - b2;
    const profitIf2 = (b2 * (o2 - 1)) - b1;

    const totalRisk = b1 + b2;

    const avgProfit = (profitIf1 + profitIf2) / 2;
    const avgRoi = totalRisk > 0 ? (avgProfit / totalRisk) * 100 : 0;

    $("p1").textContent = fmtMoney(profitIf1);
    $("p2").textContent = fmtMoney(profitIf2);
    $("riskEl").textContent = fmtMoney(totalRisk);
    $("roiAvg").textContent = fmtPct(avgRoi);

    const b1Obj = selBook1.getObj();
    const b2Obj = selBook2.getObj();

    $("chip1").innerHTML = "";
    $("chip1").appendChild(makeMiniChip(b1Obj));

    $("chip2").innerHTML = "";
    $("chip2").appendChild(makeMiniChip(b2Obj));

    $("row1").style.setProperty("--row-accent", ACCENTS[b1Obj.v] || "rgba(99,102,241,.18)");
    $("row2").style.setProperty("--row-accent", ACCENTS[b2Obj.v] || "rgba(99,102,241,.18)");

    setGlowVars();
  }

  ["input","change"].forEach(ev=>{
    $("bet1").addEventListener(ev, updateArb);
    $("odds1").addEventListener(ev, updateArb);
    $("bet2").addEventListener(ev, updateArb);
    $("odds2").addEventListener(ev, updateArb);
  });

  updateArb();

  function submitBet(){
    const dateStr = $("date").value;
    if(!dateStr){ alert("Choisis une date."); return; }
    const [year, month, day] = dateStr.split("-").map(Number);

    const payload = {
      year, month, day,
      desc: $("desc").value.trim(),
      bet1: $("bet1").value ? Number($("bet1").value) : "",
      book1: selBook1.getValue(),
      odds1: $("odds1").value ? Number($("odds1").value) : "",
      bet2: $("bet2").value ? Number($("bet2").value) : "",
      book2: selBook2.getValue(),
      odds2: $("odds2").value ? Number($("odds2").value) : "",
      outcome: selOutcome.getValue() || "N/A"
    };

    setStatus("✅ Sent (instant).");

    const blob = new Blob([JSON.stringify(payload)], { type: "text/plain;charset=utf-8" });
    const ok = navigator.sendBeacon(URL, blob);
    if(!ok){
      fetch(URL,{
        method:"POST",
        headers:{ "Content-Type":"text/plain;charset=utf-8" },
        body: JSON.stringify(payload)
      }).catch(()=>{});
    }
  }

  $("desc").focus();
</script>
</body>
</html>

